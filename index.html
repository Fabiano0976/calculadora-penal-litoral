<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora Penal Litoral City</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #020617;
      color: #e5e7eb;
      padding: 24px;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      background: radial-gradient(circle at top, #0f172a 0, #020617 55%);
      border-radius: 20px;
      border: 1px solid #1f2937;
      box-shadow: 0 25px 50px rgba(0,0,0,0.6);
      padding: 28px 28px 20px;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
      position: relative;
    }

    header h1 {
      font-size: 26px;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: #facc15;
      text-shadow: 0 0 18px rgba(34,197,255,0.38);
    }

    header p {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 4px;
    }

    .grid-main {
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.4fr);
      gap: 18px;
    }

    .card {
      background: rgba(15,23,42,0.96);
      border-radius: 14px;
      padding: 14px 16px 16px;
      border: 1px solid rgba(148,163,184,0.2);
    }

    .card h2 {
      font-size: 15px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .card h2::before {
      content: "";
      width: 3px;
      height: 18px;
      border-radius: 999px;
      background: linear-gradient(180deg,#22d3ee,#3b82f6);
    }

    label {
      font-size: 13px;
      color: #e5e7eb;
      display: block;
      margin-bottom: 3px;
    }

    input[type="text"],
    input[type="number"],
    select {
      width: 100%;
      padding: 7px 10px;
      border-radius: 9px;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      font-size: 13px;
      outline: none;
      margin-bottom: 8px;
    }

    input:focus,
    select:focus {
      border-color: #0ea5e9;
      box-shadow: 0 0 0 1px rgba(14,165,233,0.35);
    }

    .row {
      display: grid;
      grid-template-columns: repeat(2,minmax(0,1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 8px 18px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(90deg,#22c1ff,#2563eb);
      color: #0b1020;
      letter-spacing: .03em;
      text-transform: uppercase;
      transition: transform .08s, box-shadow .08s, filter .08s;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 15px 25px rgba(37,99,235,.45);
      filter: brightness(1.03);
    }

    button.small {
      padding: 4px 10px;
      font-size: 11px;
      border-radius: 999px;
    }

    .btn-danger {
      background: linear-gradient(90deg,#f97373,#ef4444);
      color: #f9fafb;
      box-shadow: none;
    }

    .btn-danger:hover {
      box-shadow: 0 10px 22px rgba(248,113,113,0.36);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-top: 4px;
    }

    th, td {
      padding: 4px 6px;
      border-bottom: 1px solid rgba(30,41,59,0.9);
    }

    th {
      text-align: left;
      color: #9ca3af;
      font-weight: 500;
      background: #020617;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    tbody tr:nth-child(even) {
      background: rgba(15,23,42,0.7);
    }

    .totais {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
      font-size: 12px;
    }

    .badge {
      flex: 1 1 120px;
      background: #020617;
      border-radius: 999px;
      border: 1px solid #1f2937;
      padding: 6px 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .badge span {
      color: #38bdf8;
      font-weight: 600;
    }

    .checks {
      display: grid;
      grid-template-columns: repeat(2,minmax(0,1fr));
      gap: 6px;
      margin-top: 4px;
      font-size: 13px;
    }

    .checks label {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .checks input[type="checkbox"] {
      width: 15px;
      height: 15px;
      accent-color: #22c1ff;
    }

    .btn-block {
      margin-top: 10px;
      width: 100%;
      text-align: center;
    }

    .result-block {
      margin-top: 6px;
      padding: 8px 10px;
      border-radius: 10px;
      background: #020617;
      border: 1px solid #1f2937;
      font-size: 13px;
    }

    .result-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #9ca3af;
      margin-bottom: 2px;
    }

    .result-main {
      font-size: 22px;
      font-weight: 700;
      color: #facc15;
      margin-bottom: 2px;
    }

    .result-extra {
      font-size: 12px;
      color: #d1d5db;
    }

    .status-main {
      font-size: 18px;
      font-weight: 700;
      color: #38bdf8;
      margin-bottom: 2px;
    }

    .status-extra {
      font-size: 12px;
      color: #e5e7eb;
    }

    textarea {
      width: 100%;
      min-height: 140px;
      resize: vertical;
      border-radius: 10px;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      padding: 8px 10px;
      font-size: 12px;
      outline: none;
      margin-top: 4px;
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    textarea:focus {
      border-color: #0ea5e9;
      box-shadow: 0 0 0 1px rgba(14,165,233,0.35);
    }

    .footer {
      margin-top: 12px;
      font-size: 11px;
      text-align: center;
      color: #6b7280;
    }

    .situacao-select {
      margin-top: 8px;
    }

    .situacao-select select {
      margin-bottom: 0;
    }

    @media (max-width: 900px) {
      .grid-main {
        grid-template-columns: 1fr;
      }
      .page {
        padding: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <h1>CALCULADORA PENAL LITORAL CITY</h1>
      <p>Calcule serviços, multa e fiança com base no Código Penal da Litoral City e gere texto pronto para o Discord.</p>
    </header>

    <div class="grid-main">
      <!-- ESQUERDA: DADOS + ARTIGOS -->
      <div class="card">
        <h2>Dados do detento</h2>
        <div class="row">
          <div>
            <label for="nomeDetento">Nome</label>
            <input id="nomeDetento" type="text" placeholder="Ex: Wood" />
          </div>
          <div>
            <label for="cpfDetento">CPF</label>
            <input id="cpfDetento" type="text" placeholder="Ex: 12345" />
          </div>
        </div>

        <h2 style="margin-top:10px;">Artigos</h2>
        <p style="font-size:11px;color:#9ca3af;margin-bottom:6px;">
          Digite o código (ex: <b>10</b>, <b>10.1</b>, <b>23.2</b>) ou selecione na lista e clique em <b>Adicionar</b>.
        </p>

        <div class="row">
          <div>
            <label for="inputCodigo">Código do artigo</label>
            <input id="inputCodigo" type="text" placeholder="Ex: 10, 10.1, 23, 36.4..." />
          </div>
          <div>
            <label for="inputObsArtigo">Observação (opcional)</label>
            <input id="inputObsArtigo" type="text" placeholder="Ex: local, situação..." />
          </div>
        </div>

        <label for="selectArtigo">Ou selecionar</label>
        <div style="display:flex; gap:8px; align-items:center; margin-bottom:6px;">
          <select id="selectArtigo">
            <option value="">Selecione um artigo...</option>
          </select>
          <button id="btnAdicionarArtigo" style="white-space:nowrap;">Adicionar artigo</button>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width:45px;">Cód.</th>
              <th>Descrição</th>
              <th style="width:60px;">Serv.</th>
              <th style="width:90px;">Multa</th>
              <th style="width:90px;">Fiança</th>
              <th style="width:60px;"></th>
            </tr>
          </thead>
          <tbody id="tabelaArtigosBody"></tbody>
        </table>

        <div class="totais">
          <div class="badge">
            <span>Serviços</span>
            <div id="totalServicos">0</div>
          </div>
          <div class="badge">
            <span>Multa</span>
            <div id="totalMulta">R$ 0</div>
          </div>
          <div class="badge">
            <span>Fiança</span>
            <div id="totalFianca">R$ 0</div>
          </div>
        </div>
      </div>

      <!-- DIREITA: REDUÇÕES + RESULTADO -->
      <div class="card">
        <h2>Reduções / Benefícios</h2>
        <div class="checks">
          <label>
            <input type="checkbox" id="chkReuPrimario" />
            Réu primário (-30%)
          </label>
          <label>
            <input type="checkbox" id="chkAdvogado" />
            Detenção com advogado (-30%)
          </label>
          <label>
            <input type="checkbox" id="chkCooperacao" />
            Cooperação / rendição (-10%)
          </label>
          <label>
            <input type="checkbox" id="chkDelacao" />
            Delação premiada (-50%)
          </label>
        </div>

        <div class="btn-block">
          <button id="btnCalcular">Calcular pena final</button>
        </div>

        <div class="result-block" style="margin-top:12px;">
          <div class="result-title">Pena de serviços</div>
          <div class="result-main"><span id="penaFinal">0</span> meses</div>
          <div class="result-extra">
            Multa total: <b id="resultadoMulta">R$ 0</b><br/>
            Fiança total: <b id="resultadoFianca">R$ 0</b>
          </div>
        </div>

        <div class="result-block" style="margin-top:10px;">
          <div class="result-title">Status sugerido</div>
          <div class="status-main" id="statusTitulo">—</div>
          <div class="status-extra" id="statusTexto">
            Adicione artigos e calcule para ver o status.
          </div>
        </div>

        <div class="situacao-select">
          <label for="selectSituacao" style="font-size:12px;color:#9ca3af;">Situação (para texto do Discord)</label>
          <select id="selectSituacao">
            <option value="">Selecione uma situação...</option>
            <option value="Foi encaminhado para o Centro de Detenção.">
              Foi encaminhado para o Centro de Detenção.
            </option>
            <option value="Pagou a fiança e foi liberado.">
              Pagou a fiança e foi liberado.
            </option>
          </select>
        </div>

        <div class="result-block" style="margin-top:10px;">
          <div class="result-title">Resumo para Discord</div>
          <textarea id="resumoDiscord" placeholder="Calcule a pena para gerar o texto."></textarea>
          <div style="margin-top:6px; text-align:right;">
            <button id="btnCopiar" class="small">Copiar texto</button>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      Baseado no Código Penal da Litoral City. Ajuste valores se houver atualização oficial.
    </div>
  </div>

  <script>
    // ============================
    // TABELA DE ARTIGOS (resumo)
    // ============================
    // cód: { descricao, servicos, multa, fianca }
    const artigos = {
      "10":   { descricao: "Homicídio doloso", servicos: 60, multa: 60000, fianca: 0 },
      "10.1": { descricao: "Homicídio culposo", servicos: 40, multa: 40000, fianca: 0 },
      "10.2": { descricao: "Homicídio a oficial", servicos: 60, multa: 50000, fianca: 0 },
      "10.3": { descricao: "Latrocínio", servicos: 50, multa: 40000, fianca: 0 },
      "11":   { descricao: "Tentativa de homicídio", servicos: 40, multa: 35000, fianca: 0 },
      "11.1": { descricao: "Tentativa a oficial", servicos: 50, multa: 40000, fianca: 0 },
      "11.2": { descricao: "Múltiplos homicídios", servicos: 60, multa: 60000, fianca: 0 },
      "12":   { descricao: "Sequestro e cárcere privado", servicos: 40, multa: 30000, fianca: 0 },
      "12.1": { descricao: "Sequestro a oficial", servicos: 60, multa: 35000, fianca: 0 },
      "12.2": { descricao: "Extorsão mediante sequestro", servicos: 50, multa: 40000, fianca: 0 },

      "14.1": { descricao: "Difamação", servicos: 15, multa: 6000, fianca: 14000 },
      "14.2": { descricao: "Calúnia", servicos: 15, multa: 6000, fianca: 14000 },
      "14.3": { descricao: "Injúria", servicos: 25, multa: 14000, fianca: 20000 },
      "15":   { descricao: "Ameaça", servicos: 20, multa: 8000, fianca: 16000 },
      "15.1": { descricao: "Ameaça contra oficial", servicos: 30, multa: 10000, fianca: 20000 },
      "15.2": { descricao: "Ameaça com violência", servicos: 30, multa: 10000, fianca: 20000 },

      "17":   { descricao: "Crueldade animal", servicos: 20, multa: 12000, fianca: 24000 },
      "18":   { descricao: "Lesão corporal", servicos: 20, multa: 6000, fianca: 14000 },
      "19":   { descricao: "Omissão de socorro", servicos: 15, multa: 7000, fianca: 18000 },
      "20":   { descricao: "Danos morais", servicos: 15, multa: 5000, fianca: 10000 },
      "20.1": { descricao: "Assédio moral", servicos: 60, multa: 50000, fianca: 100000 },
      "21":   { descricao: "Ato obsceno", servicos: 20, multa: 6000, fianca: 14000 },
      "21.1": { descricao: "Atentado ao pudor", servicos: 60, multa: 120000, fianca: 0 },

      "23":   { descricao: "Roubo", servicos: 30, multa: 8000, fianca: 20000 },
      "23.1": { descricao: "Tentativa de roubo", servicos: 20, multa: 6000, fianca: 14000 },
      "23.2": { descricao: "Furto", servicos: 10, multa: 5000, fianca: 12000 },
      "24":   { descricao: "Assalto à loja", servicos: 40, multa: 15000, fianca: 32000 },
      "25":   { descricao: "Assalto a banco (pequeno porte)", servicos: 45, multa: 20000, fianca: 44000 },
      "26":   { descricao: "Assalto à joalheria", servicos: 50, multa: 25000, fianca: 48000 },
      "27":   { descricao: "Assalto ao Banco Central", servicos: 100, multa: 50000, fianca: 120000 },
      "28":   { descricao: "Roubo a registradora", servicos: 25, multa: 12000, fianca: 28000 },
      "29":   { descricao: "Roubo a caixa eletrônico", servicos: 30, multa: 16000, fianca: 32000 },
      "30":   { descricao: "Assalto a loja de armas", servicos: 40, multa: 18000, fianca: 38000 },
      "31":   { descricao: "Lavagem / ocultação de bens", servicos: 60, multa: 34000, fianca: 76000 },
      "32":   { descricao: "Dano ao patrimônio", servicos: 40, multa: 15000, fianca: 32000 },
      "32.1": { descricao: "Invasão à propriedade", servicos: 20, multa: 8000, fianca: 18000 },
      "33":   { descricao: "Receptação", servicos: 30, multa: 16000, fianca: 32000 },
      "34":   { descricao: "Estelionato", servicos: 40, multa: 12000, fianca: 38000 },
      "34.1": { descricao: "Extorsão", servicos: 30, multa: 16000, fianca: 36000 },
      "34.2": { descricao: "Evasão financeira", servicos: 30, multa: 15000, fianca: 34000 },

      "36":   { descricao: "Posse de substâncias ilícitas", servicos: 30, multa: 18000, fianca: 40000 },
      "36.1": { descricao: "Posse ilegal de armas (baixo calibre)", servicos: 40, multa: 20000, fianca: 48000 },
      "36.2": { descricao: "Posse de itens de servidores públicos", servicos: 40, multa: 24000, fianca: 52000 },
      "36.3": { descricao: "Posse de dinheiro sujo abaixo de 100.000", servicos: 20, multa: 40000, fianca: 82000 },
      "36.4": { descricao: "Posse de dinheiro sujo acima de 100.000", servicos: 40, multa: 80000, fianca: 180000 },
      "37":   { descricao: "Tráfico de órgãos", servicos: 40, multa: 70000, fianca: 140000 },
      "38":   { descricao: "Tráfico de armas e munições", servicos: 50, multa: 70000, fianca: 160000 },
      "38.1": { descricao: "Posse de equipamento balístico", servicos: 40, multa: 26000, fianca: 56000 },
      "39":   { descricao: "Tráfico de armas médio/alto calibre", servicos: 60, multa: 90000, fianca: 180000 },
      "40":   { descricao: "Dinheiro sujo abaixo de 40.000", servicos: 30, multa: 20000, fianca: 62000 },

      "41":   { descricao: "Corrupção passiva", servicos: 40, multa: 30000, fianca: 80000 },
      "41.1": { descricao: "Corrupção de autoridade", servicos: 50, multa: 100000, fianca: 220000 },
      "42":   { descricao: "Corrupção ativa", servicos: 60, multa: 60000, fianca: 140000 },
      "42.1": { descricao: "Tentativa de suborno", servicos: 30, multa: 30000, fianca: 84000 },
      "43":   { descricao: "Obstrução de justiça", servicos: 40, multa: 60000, fianca: 128000 },
      "43.1": { descricao: "Omissão ou obstrução de provas", servicos: 30, multa: 30000, fianca: 64000 },
      "44":   { descricao: "Prevaricação", servicos: 60, multa: 80000, fianca: 160000 },
      "44.1": { descricao: "Abuso de autoridade", servicos: 20, multa: 24000, fianca: 56000 },
      "45":   { descricao: "Usurpação de função pública", servicos: 60, multa: 60000, fianca: 120000 },
      "46":   { descricao: "Abolição violenta do Estado Democrático de Direito", servicos: 60, multa: 50000, fianca: 120000 },
      "47":   { descricao: "Associação criminosa", servicos: 40, multa: 18000, fianca: 40000 },
      "48":   { descricao: "Falsidade ideológica", servicos: 20, multa: 6000, fianca: 18000 },
      "49":   { descricao: "Impossibilidade de identificação", servicos: 10, multa: 6000, fianca: 12000 },
      "50":   { descricao: "Falso testemunho (perjúrio)", servicos: 40, multa: 40000, fianca: 86000 },
      "51":   { descricao: "Lei de propriedade industrial", servicos: 60, multa: 80000, fianca: 150000 },
      "51.1": { descricao: "Empresa irregular", servicos: 70, multa: 50000, fianca: 100000 },
      "51.2": { descricao: "Crime contra relações de consumo", servicos: 30, multa: 54000, fianca: 120000 },
      "52":   { descricao: "Venda ilegal de produtos restritos sem licença", servicos: 25, multa: 40000, fianca: 90000 },
      "53":   { descricao: "Favorecimento pessoal", servicos: 40, multa: 30000, fianca: 90000 },

      "54":   { descricao: "Desordem social", servicos: 15, multa: 5000, fianca: 12000 },
      "54.1": { descricao: "Apologia ao crime", servicos: 30, multa: 50000, fianca: 110000 },
      "55":   { descricao: "Desacato", servicos: 20, multa: 12000, fianca: 26000 },
      "56":   { descricao: "Desobediência", servicos: 15, multa: 10000, fianca: 22000 },
      "57":   { descricao: "Resistência à prisão", servicos: 20, multa: 5000, fianca: 15000 },
      "58":   { descricao: "Fuga de pessoa presa ou submetida a medida de segurança", servicos: 20, multa: 16000, fianca: 38000 },
      "58.1": { descricao: "Fuga de abordagem policial", servicos: 20, multa: 8000, fianca: 20000 },
      "59":   { descricao: "Ocultação facial", servicos: 10, multa: 8000, fianca: 18000 },
      "60":   { descricao: "Multas pendentes acima de 50.000", servicos: 30, multa: 8000, fianca: 100000 },
      "61":   { descricao: "Poluição sonora", servicos: 10, multa: 6000, fianca: 12000 },
      "62":   { descricao: "Não respeitar perímetro da ação", servicos: 10, multa: 20000, fianca: 12000 },
      "63":   { descricao: "Excesso de ficha criminal", servicos: 60, multa: 10000, fianca: 15000 },

      "66":   { descricao: "Excesso de velocidade", servicos: 0, multa: 8000, fianca: 0 },
      "67":   { descricao: "Atropelamento", servicos: 10, multa: 5000, fianca: 15000 },
      "68":   { descricao: "Direção perigosa", servicos: 10, multa: 5000, fianca: 15000 },
      "68.1": { descricao: "Corrida ilegal", servicos: 20, multa: 14000, fianca: 34000 },
      "69":   { descricao: "Veículo em local proibido", servicos: 0, multa: 4000, fianca: 0 },
      "70":   { descricao: "Veículo abandonado", servicos: 0, multa: 5000, fianca: 0 },
      "71":   { descricao: "Veículo danificado (sem condições de segurança)", servicos: 0, multa: 3000, fianca: 0 },
      "72":   { descricao: "Uso de veículo de terceiros para crimes", servicos: 30, multa: 30000, fianca: 68000 },
      "73":   { descricao: "Tráfego aéreo irregular", servicos: 50, multa: 30000, fianca: 80000 },
      "73.1": { descricao: "Pouso em local indevido", servicos: 10, multa: 40000, fianca: 0 },
      "73.2": { descricao: "Pilotagem perigosa", servicos: 10, multa: 50000, fianca: 0 }
    };

    // Lista de artigos adicionados
    let listaArtigos = [];

    // Referências de elementos
    const selectArtigo        = document.getElementById("selectArtigo");
    const inputCodigo         = document.getElementById("inputCodigo");
    const inputObsArtigo      = document.getElementById("inputObsArtigo");
    const tabelaArtigosBody   = document.getElementById("tabelaArtigosBody");

    const totalServicosSpan   = document.getElementById("totalServicos");
    const totalMultaSpan      = document.getElementById("totalMulta");
    const totalFiancaSpan     = document.getElementById("totalFianca");

    const penaFinalSpan       = document.getElementById("penaFinal");
    const resultadoMultaSpan  = document.getElementById("resultadoMulta");
    const resultadoFiancaSpan = document.getElementById("resultadoFianca");

    const statusTituloSpan    = document.getElementById("statusTitulo");
    const statusTextoSpan     = document.getElementById("statusTexto");

    const chkReuPrimario      = document.getElementById("chkReuPrimario");
    const chkAdvogado         = document.getElementById("chkAdvogado");
    const chkCooperacao       = document.getElementById("chkCooperacao");
    const chkDelacao          = document.getElementById("chkDelacao");

    const selectSituacao      = document.getElementById("selectSituacao");
    const resumoDiscord       = document.getElementById("resumoDiscord");

    // ============================
    // FUNÇÕES
    // ============================
    function formatarMoeda(valor) {
      return valor.toLocaleString("pt-BR", {
        style: "currency",
        currency: "BRL",
        minimumFractionDigits: 2
      });
    }

    function atualizarSelectArtigos() {
      Object.entries(artigos).forEach(([codigo, dados]) => {
        const opt = document.createElement("option");
        opt.value = codigo;
        opt.textContent = `${codigo} - ${dados.descricao}`;
        selectArtigo.appendChild(opt);
      });
    }

    function adicionarArtigoPorCodigo(codigoStr) {
      const codigo = codigoStr.trim();
      if (!codigo) return;

      const dados = artigos[codigo];
      if (!dados) {
        alert("Artigo não encontrado no Código Penal. Confira o código (ex: 10, 10.1, 23.2).");
        return;
      }

      let descricaoFinal = dados.descricao;
      const extra = inputObsArtigo.value.trim();
      if (extra) descricaoFinal += " (" + extra + ")";

      listaArtigos.push({
        codigo: codigo,
        descricao: descricaoFinal,
        servicos: dados.servicos,
        multa: dados.multa,
        fianca: dados.fianca
      });

      inputCodigo.value = "";
      inputObsArtigo.value = "";
      selectArtigo.value = "";

      renderTabela();
      atualizarTotais();
    }

    function removerArtigo(index) {
      listaArtigos.splice(index, 1);
      renderTabela();
      atualizarTotais();
    }

    function renderTabela() {
      tabelaArtigosBody.innerHTML = "";
      listaArtigos.forEach((item, index) => {
        const tr = document.createElement("tr");

        const tdCod = document.createElement("td");
        tdCod.textContent = item.codigo;
        tr.appendChild(tdCod);

        const tdDesc = document.createElement("td");
        tdDesc.textContent = item.descricao;
        tr.appendChild(tdDesc);

        const tdServ = document.createElement("td");
        tdServ.textContent = item.servicos;
        tr.appendChild(tdServ);

        const tdMulta = document.createElement("td");
        tdMulta.textContent = formatarMoeda(item.multa);
        tr.appendChild(tdMulta);

        const tdFianca = document.createElement("td");
        tdFianca.textContent = formatarMoeda(item.fianca);
        tr.appendChild(tdFianca);

        const tdAcoes = document.createElement("td");
        const btnRemover = document.createElement("button");
        btnRemover.textContent = "Remover";
        btnRemover.className = "small btn-danger";
        btnRemover.onclick = () => removerArtigo(index);
        tdAcoes.appendChild(btnRemover);
        tr.appendChild(tdAcoes);

        tabelaArtigosBody.appendChild(tr);
      });
    }

    function atualizarTotais() {
      const totalServicos = listaArtigos.reduce((s, a) => s + a.servicos, 0);
      const totalMulta = listaArtigos.reduce((s, a) => s + a.multa, 0);
      const totalFianca = listaArtigos.reduce((s, a) => s + a.fianca, 0);

      totalServicosSpan.textContent = totalServicos;
      totalMultaSpan.textContent = formatarMoeda(totalMulta);
      totalFiancaSpan.textContent = formatarMoeda(totalFianca);
    }

    function calcularPenaFinal() {
      if (listaArtigos.length === 0) {
        alert("Adicione pelo menos um artigo antes de calcular.");
        return;
      }

      const totalServicos = listaArtigos.reduce((s, a) => s + a.servicos, 0);
      const totalMulta = listaArtigos.reduce((s, a) => s + a.multa, 0);
      const totalFianca = listaArtigos.reduce((s, a) => s + a.fianca, 0);

      let pena = totalServicos;

      // Reduções (baseado nas observações gerais do código penal)
      if (chkReuPrimario.checked) pena *= 0.7;   // -30%
      if (chkAdvogado.checked)    pena *= 0.7;   // -30%
      if (chkCooperacao.checked)  pena *= 0.9;   // -10%
      if (chkDelacao.checked)     pena *= 0.5;   // -50%

      pena = Math.round(pena);
      if (pena < 0) pena = 0;

      // Atualiza resultado principal
      penaFinalSpan.textContent = pena;
      resultadoMultaSpan.textContent = formatarMoeda(totalMulta);
      resultadoFiancaSpan.textContent = formatarMoeda(totalFianca);

      // Status sugerido:
      let statusTitulo = "";
      let statusTexto  = "";

      if (pena === 0 && totalMulta > 0 && totalServicos === 0) {
        statusTitulo = "MULTA";
        statusTexto  = "Aplicada apenas multa, sem cumprimento de pena de serviços.";
      } else if (totalFianca > 0 && pena <= 20) {
        statusTitulo = "LIBERDADE";
        statusTexto  = "Liberdade mediante pagamento integral da fiança.";
      } else if (pena > 0 && pena <= 25) {
        statusTitulo = "PENA PARCIAL";
        statusTexto  = "Pena moderada. Avaliar possibilidade de acordo ou regime mais brando.";
      } else {
        statusTitulo = "PRISÃO";
        statusTexto  = "Pena alta. Cumprimento integral conforme o Código Penal da cidade.";
      }

      statusTituloSpan.textContent = statusTitulo;
      statusTextoSpan.textContent  = statusTexto;

      gerarResumoDiscord(pena, totalMulta, totalFianca);
    }

    function gerarResumoDiscord(penaFinal, totalMulta, totalFianca) {
      const nome = (document.getElementById("nomeDetento").value || "").trim() || "Não informado";
      const cpf  = (document.getElementById("cpfDetento").value  || "").trim() || "Não informado";

      const artigosLista = listaArtigos.map(a => a.codigo).join(", ") || "Nenhum";
      const status = statusTituloSpan.textContent || "PENA";

      let situacaoTexto = selectSituacao.value;
      // Se for só multa, força uma situação padrão de multa
      if (status === "MULTA") {
        situacaoTexto = "Foi apenas multado, sem cumprimento de pena.";
      }

      let texto = `***${status}***\n`;
      if (situacaoTexto) {
        texto += `> Situação: ${situacaoTexto}\n\n`;
      } else {
        texto += `\n`;
      }

      texto += `Nome: ${nome}\n`;
      texto += `CPF: ${cpf}\n`;
      texto += `Artigos: ${artigosLista}\n`;
      texto += `Pena: ${penaFinal} meses\n`;
      texto += `Multa: ${formatarMoeda(totalMulta)}\n`;
      texto += `Fiança: ${formatarMoeda(totalFianca)}\n`;
      texto += `------------------------------`;

      resumoDiscord.value = texto;
    }

    function copiarResumo() {
      resumoDiscord.select();
      document.execCommand("copy");
    }

    // ============================
    // EVENTOS
    // ============================
    document.getElementById("btnAdicionarArtigo").addEventListener("click", () => {
      const codInput  = inputCodigo.value.trim();
      const codSelect = selectArtigo.value;
      const codigo = codInput || codSelect;

      if (!codigo) {
        alert("Informe um código ou selecione um artigo.");
        return;
      }

      adicionarArtigoPorCodigo(codigo);
    });

    inputCodigo.addEventListener("keyup", (e) => {
      if (e.key === "Enter") {
        document.getElementById("btnAdicionarArtigo").click();
      }
    });

    document.getElementById("btnCalcular").addEventListener("click", calcularPenaFinal);
    document.getElementById("btnCopiar").addEventListener("click", copiarResumo);

    // Inicializa select de artigos ao carregar
    atualizarSelectArtigos();
  </script>
</body>
</html>
